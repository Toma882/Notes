# Unity UGUI

## Unity的UI渲染顺序
第一步计算每个UI元素的层级号；第二步合并相同层级号中可以Batch的元素作为一个批次，并对批次进行排序；

第一步，先从直观的角度来解释计算层级的算法：
1. 如果有一个UI元素，它所占的屏幕范围内（通常是矩形），如果没有任何UI在它的底下，那么它的层级号就是0（最底下）；
1. 如果有一个UI在其底下且该UI可以和它Batch，那它的层级号与底下的UI层级一样；
1. 如果有一个UI在其底下但是无法与它Batch，那它的层级号为底下的UI的层级+1；
1. 如果有多个UI都在其下面，那么按前两种方式遍历计算所有的层级号，其中最大的那个作为自己的层级号。

第二步：  
1. Unity会将每一层的所有元素进行一个排序（按照材质、纹理等信息），合并掉可以Batch的元素成为一个批次；
1. Text组件会排在Image组件之前渲染。经过以上排序，就可以得到一个有序的批次序列了。
1. 这时，Unity会再做一个优化，即如果相邻间的两个批次正好可以Batch的话就会进行Batch。

## 参考
* [[Unity优化]批处理05：UGUI](https://www.cnblogs.com/lyh916/p/10888720.html)